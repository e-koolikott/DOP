<!--View-->
<md-card class=" card-lg">
  <md-card-content data-ng-if="!$ctrl.isLicensesEditMode()" data-ng-repeat="licence in $ctrl.licenses track by $index">
    <h2 class="chapter-title"
        data-ng-bind-html="$ctrl.getCurrentLanguage() === 'est' ? licence.titleEst: $ctrl.getCurrentLanguage() === 'eng' ? licence.titleEng : licence.titleRus"></h2>
    <div>
      <span class="term-block"
            data-ng-bind-html="$ctrl.getCurrentLanguage() === 'est' ? licence.contentEst: $ctrl.getCurrentLanguage() === 'eng' ? licence.contentEng : licence.contentRus"></span>
    </div>
  </md-card-content>
</md-card>

<!-- Edit mode -->
<form name="termsForm">
  <md-card data-ng-if="$ctrl.isLicensesEditMode()" class="portfolio-chapter card-lg faq-font"
           data-ng-repeat="licence in $ctrl.licenses track by $index">
    <div>
      <md-card-content data-ng-if="!licence.edit">
        <div data-layout="row" data-layout-align="space-between center">
          <h2 class="chapter-title"
              data-ng-bind-html="$ctrl.getCurrentLanguage() === 'est' ? licence.titleEst : $ctrl.getCurrentLanguage() === 'eng' ? licence.titleEng : licence.titleRus"></h2>
          <md-button class="md-icon-button chapter-pencil-button"
                     data-ng-click="$ctrl.editLicence(licence)"
                     id="licence-edit"
                     data-ng-if="$ctrl.isLicensesEditMode() && !$ctrl.isCreateDialogOpen()">
            <md-icon class="material-icons">edit</md-icon>
            <md-tooltip><span data-translate="TERMS_EDIT"></span></md-tooltip>
          </md-button>
        </div>
        <div>
          <span class="term-block"
                data-ng-bind-html="$ctrl.getCurrentLanguage() === 'est' ? licence.contentEst : $ctrl.getCurrentLanguage() === 'eng' ? licence.contentEng : licence.contentRus"></span>
        </div>
      </md-card-content>
      <md-card-content data-ng-if="licence.edit">
        <div
          data-ng-repeat="lang in licence.licenceLanguages track by $index"
          data-ng-if="lang === licence.activeLicenceLanguage && true"
          layout="row"
          layout-wrap>
          <div layout-xs="column" layout-align-xs="start stretch" layout-align="start center" flex-order="2"
               flex-order-gt-sm="2" flex="100" data-ng-if="true">
            <div ng-if="lang === 'ET'" data-layout-align="start stretch" layout="column" data-flex="100">
              <md-input-container class="md-block animate-if remaining-charaters-wrapper" flex>
                <label data-translate="TERM_TITLE"></label>
                <input
                  name="title"
                  id="add-title-est"
                  ng-model="licence.titleEst"
                  maxlength="100"
                  required>
                <div data-ng-messages="termsForm.title.$error">
                  <div data-ng-message="required" data-translate="TERM_TITLE_REQUIRED"></div>
                </div>
              </md-input-container>
              <div class="md-block animate-if remaining-charaters-wrapper" flex>
                <trix-editor class="term-block" angular-trix ng-model="licence.contentEst"></trix-editor>
              </div>
            </div>
            <div ng-if="lang === 'EN'" data-layout-align="start stretch" layout="column" data-flex="100">
              <md-input-container class="md-block animate-if remaining-charaters-wrapper" flex>
                <label data-translate="TERM_TITLE"></label>
                <input
                  name="title"
                  id="add-title-eng"
                  ng-model="licence.titleEng"
                  maxlength="100"
                  required>
                <div data-ng-messages="termsForm.title.$error">
                  <div data-ng-message="required" data-translate="TERM_TITLE_REQUIRED"></div>
                </div>
              </md-input-container>
              <div class="md-block animate-if remaining-charaters-wrapper" flex>
                <trix-editor class="term-block" angular-trix ng-model="licence.contentEng"></trix-editor>
              </div>
            </div>
            <div ng-if="lang === 'RU'" data-layout-align="start stretch" layout="column" data-flex="100">
              <md-input-container class="md-block animate-if remaining-charaters-wrapper" flex>
                <label data-translate="TERM_TITLE"></label>
                <input
                  name="title"
                  id="add-title-rus"
                  ng-model="licence.titleRus"
                  maxlength="100"
                  required>
                <div data-ng-messages="termsForm.title.$error">
                  <div data-ng-message="required" data-translate="TERM_TITLE_REQUIRED"></div>
                </div>
              </md-input-container>
              <div class="md-block animate-if remaining-charaters-wrapper" flex>
                <trix-editor class="term-block" angular-trix ng-model="licence.contentRus"></trix-editor>
              </div>
            </div>
          </div>
          <div layout="column" layout-align="center center" layout-gt-xs="row" flex="100" flex-gt-sm="50" flex-order="1"
               data-ng-if="true">
            <!-- Landing page language -->
            <md-button
              class="button-material-language"
              data-ng-repeat="_lang in licence.licenceLanguages track by $index"
              data-ng-class="{'is-selected': lang === _lang}"
              data-ng-click="$ctrl.toggleLicensesLanguageInputs(licence, _lang)"
              flex-gt-xs="{{ licence.activeLicenceLanguage === _lang ? '40' : '30' }}"
              aria-label="{{ _lang }} button"
            >
              <span data-ng-bind-html="_lang"></span>
              <md-icon class="button-material-language__icon"
                       data-ng-if="$ctrl.isLangFilled(_lang, licence) || licence.activeLicenceLanguage === _lang">done
              </md-icon>
            </md-button>
          </div>
          <div data-flex-order="3" flex="100" class="flex flex-col">
          </div>
        </div>
        <div class="md-padding" flex="50" data-ng-if="$index === 0">
          <md-checkbox class="md-primary checkbox--material-author" ng-click="$ctrl.notifyOfGDPRUpdate()"
                       data-ng-checked="notifyOfGDPRUpdate" aria-label="{{ 'TERM_NOTIFY_GDPR' | translate }}">
            <span data-translate="TERM_NOTIFY_GDPR"></span>
          </md-checkbox>
        </div>
        <div data-layout="row" data-layout-align="space-between center">

          <md-button
            aria-label="Delete licence"
            id="licence-delete-button"
            data-ng-click="$ctrl.delete(licence)"
            class="md-button md-ink-ripple"
            data-ng-disabled="licence.new"
          >
            <span data-translate="BUTTON_REMOVE"></span>
          </md-button>
          <div layout="row" layout-align="end center" class="md-padding md-padding-horizontal-double"
               data-ng-if="true">
            <md-button
              aria-label="Cancel licence edit"
              id="licence-cancel-edit"
              data-ng-click="$ctrl.cancelEdit(licence)"
              class="md-button md-ink-ripple"
            >
              <span data-translate="BUTTON_CANCEL"></span>
            </md-button>
            <md-button
              aria-label="{{ 'BUTTON_ADD_TERM' | translate }}"
              id="licence-save"
              class="md-primary"
              data-ng-disabled="$ctrl.isSubmitDisabled(licence) || isSaving"
              data-ng-click="$ctrl.save(licence)"
              data-ng-if="licence.new"
            >
              <span data-translate="{{ 'BUTTON_ADD_TERM' }}"></span>
            </md-button>
            <md-button
              aria-label="{{ 'BUTTON_UPDATE_TERM' | translate }}"
              id="licence-update"
              class="md-primary"
              data-ng-disabled="$ctrl.isSubmitDisabled(licence) || isSaving"
              data-ng-click="$ctrl.save(licence)"
              data-ng-if="!licence.new"
            >
              <span data-translate="{{ 'BUTTON_UPDATE_TERM' }}"></span>
            </md-button>
            <md-progress-circular
              class="md-accent ng-hide"
              md-mode="indeterminate"
              md-diameter="40"
              data-ng-show="isSaving"
            ></md-progress-circular>
          </div>
        </div>
      </md-card-content>
    </div>
  </md-card>
</form>
